# EISCore 角色测试记录模板

## 1. 文档信息
| 项目 | 内容 |
|---|---|
| 项目名称 | EISCore |
| 模块/应用 | （示例：入职流程） |
| 测试轮次 | 第 __ 轮 |
| 测试环境 | （示例：本地 Docker / WSL2） |
| 测试日期 | ____-__-__ |
| 测试负责人 |  |
| 参与人员 |  |
| 版本/提交号 |  |

## 2. 测试目标
- 验证各角色在流程中的可见范围、可执行操作、越权拦截是否符合预期。
- 验证流程流转顺序、实例状态变化、审计日志记录是否正确。
- 验证“超级管理员可兜底、普通角色不可越权”的权限边界。

## 3. 角色与测试账号矩阵
| 序号 | 角色代码 | 角色名称 | 测试账号 | 预期权限摘要 |
|---|---|---|---|---|
| 1 | super_admin | 超级管理员 |  | 可查看并执行全部节点 |
| 2 | employee | 员工 |  | 仅可执行员工节点 |
| 3 | hr_clerk | 人事文员 |  | 可执行 HR 初审节点 |
| 4 | dept_manager | 部门主管 |  | 可执行部门确认节点 |
| 5 | hr_admin | 人事管理员 |  | 可执行建档/收尾节点 |
| 6 | hr_viewer | 人事只读 |  | 仅查看，不可推进流程 |

## 4. 前置条件检查
| 检查项 | 预期 | 结果（通过/失败） | 备注 |
|---|---|---|---|
| 流程应用已发布 | 可从应用中心进入 |  |  |
| 流程定义存在 | BPMN 可正常渲染 |  |  |
| 任务分派已配置 | 节点绑定到对应角色 |  |  |
| 状态映射已配置 | 关键节点有状态值 |  |  |
| 审计表可写 | 产生 instance_events |  |  |

## 5. 角色测试用例清单（核心）
| 用例ID | 测试角色 | 前置节点/状态 | 操作步骤 | 预期结果 | 实际结果 | 结论 |
|---|---|---|---|---|---|---|
| R-01 | employee | 新建实例 | 发起流程并提交至 HR 初审 | 成功，当前节点=Task_HRReview |  |  |
| R-02 | employee | Task_HRReview | 尝试推进到部门确认 | 被拒绝（403/无权限） |  |  |
| R-03 | hr_clerk | Task_HRReview | 推进到部门确认 | 成功，当前节点=Task_ManagerReview |  |  |
| R-04 | dept_manager | Task_ManagerReview | 推进到账号开通 | 成功，当前节点=Task_AccountProvision |  |  |
| R-05 | hr_admin | Task_AccountProvision | 完成流程 | 成功，实例状态=COMPLETED |  |  |
| R-06 | hr_viewer | 任意活跃实例 | 尝试推进节点 | 被拒绝（403/无权限） |  |  |
| R-07 | super_admin | 任意节点 | 执行推进/完成 | 成功（管理员兜底） |  |  |

## 6. 执行记录（逐条留痕）
| 时间 | 操作人(账号) | 操作 | 关键参数（实例ID/业务键/目标节点） | 返回结果 | 截图/日志 |
|---|---|---|---|---|---|
|  |  |  |  |  |  |
|  |  |  |  |  |  |
|  |  |  |  |  |  |

## 7. 数据库核验记录（可选）
| 核验项 | SQL/接口 | 预期 | 实际 | 结论 |
|---|---|---|---|---|
| 实例状态 | `workflow.instances` | 节点与状态一致 |  |  |
| 事件日志 | `workflow.instance_events` | 每次流转有事件 |  |  |
| 状态映射 | `app_center.workflow_state_mappings` | 节点映射生效 |  |  |
| 任务分派 | `workflow.task_assignments` | 角色限制正确 |  |  |

## 8. 缺陷记录
| 缺陷ID | 现象描述 | 复现步骤 | 严重级别 | 责任人 | 状态 | 备注 |
|---|---|---|---|---|---|---|
| BUG- |  |  | 高/中/低 |  | 待修复/已修复/已验证 |  |
| BUG- |  |  | 高/中/低 |  | 待修复/已修复/已验证 |  |

## 9. 测试结论
- 通过用例数：__ / __
- 失败用例数：__
- 阻塞问题数：__
- 是否允许进入下一阶段（是/否）：__
- 结论说明：  
  （示例：角色权限边界符合预期，可进入联调/验收阶段）

## 10. 签字确认
| 角色 | 姓名 | 日期 | 备注 |
|---|---|---|---|
| 测试执行 |  |  |  |
| 开发确认 |  |  |  |
| 业务确认 |  |  |  |

